function e(e,n,r){var t=(e=e.toLowerCase()).indexOf(n)+n.length;return t<n.length?0:parseInt(e.substring(t,t+r))}var n=function(e,n,r){void 0===r&&(r=c);try{var t=function(){function t(){var t=u.transaction(i,"readwrite").objectStore(i).put(n,e);t.onerror=function(){r(!1),f()},t.onsuccess=function(){r(!0),f()}}var o=function(){if(0==u.objectStoreNames.length)return Promise.resolve(l()).then(function(e){e||(r(!1),f())})}();return o&&o.then?o.then(t):t()},o=function(){if(!u)return Promise.resolve(v()).then(function(e){e||(r(!1),f())})}();return Promise.resolve(o&&o.then?o.then(t):t())}catch(e){return Promise.reject(e)}},r=function(e,n,r){void 0===r&&(r=c);try{var t=function(){0==u.objectStoreNames.length&&(console.warn("TinyIdb database is empty"),r(!1),f());var n=u.transaction(i,"readwrite").objectStore(i).delete(e);n.onsuccess=function(){r(!0),f()},n.onerror=function(){r(!1),f()}},o=function(){if(!u)return Promise.resolve(v()).then(function(e){e||(r(!1),f())})}();return Promise.resolve(o&&o.then?o.then(t):t())}catch(e){return Promise.reject(e)}},t=function(e,n,r){void 0===r&&(r=c);try{var t=function(){0==u.objectStoreNames.length&&(console.warn("TinyIdb database is empty"),r(null),f());var n=u.transaction(i,"readonly").objectStore(i).get(e);n.onsuccess=function(){r(n.result),f()},n.onerror=function(){r(null),f()}},o=function(){if(!u)return Promise.resolve(v()).then(function(e){e||(r(null),f())})}();return Promise.resolve(o&&o.then?o.then(t):t())}catch(e){return Promise.reject(e)}},o=function(e,n,r){void 0===r&&(r=c);try{var t=function(){function e(){var e=u.transaction(i,"readwrite").objectStore(i).clear();e.onerror=function(){r(!1),f()},e.onsuccess=function(){r(!0),f()}}var n=function(){if(0==u.objectStoreNames.length)return Promise.resolve(l()).then(function(e){e||(r(!1),f())})}();return n&&n.then?n.then(e):e()},o=function(){if(!u)return Promise.resolve(v()).then(function(e){e||(r(!1),f())})}();return Promise.resolve(o&&o.then?o.then(t):t())}catch(e){return Promise.reject(e)}},i="tinyObjStore",c=function(){},u=null,s=!0,a=[];function f(){var e=a.shift();e?(s=!1,e.fn(e.key,e.value,e.onComplete)):s=!0}function l(){var e;e=u.version,u.close();var n=window.indexedDB.open("tinyDB",e+1);return new Promise(function(e){n.onupgradeneeded=function(){u=n.result;try{u.createObjectStore(i)}catch(n){e(!1)}},n.onsuccess=function(){e(!0)}})}function v(){var e=indexedDB.open("tinyDB");return new Promise(function(n){e.onerror=function(){return n(!1)},e.onsuccess=function(){try{return u=e.result,n(!0),Promise.resolve()}catch(e){return Promise.reject(e)}},e.onblocked=function(){n(!1)}})}exports.checkSupport=function(){if(!indexedDB)return!1;var n=navigator.userAgent.toLowerCase(),r=!1;switch(!0){case n.indexOf("edge")>-1:r=!1;break;case n.indexOf("edg/")>-1:r=!0;break;case n.indexOf("opr")>-1&&!!window.opr:r=!0,e(n,"opr/",2)<15&&(r=!1);break;case n.indexOf("chrome")>-1&&!!window.chrome:r=!0,e(n,"chrome/",2)<48&&(r=!1);break;case n.indexOf("trident")>-1:r=!1;break;case n.indexOf("firefox")>-1:r=!0,e(n,"firefox/",2)<16&&(r=!1);break;case n.indexOf("safari")>-1&&n.indexOf("mobile")>-1:case n.indexOf("safari")>-1&&-1==n.indexOf("mobile"):r=!0,e(n,"version/",2)<15&&(r=!1)}return r},exports.clear=function(e){void 0===e&&(e=c),a.push({fn:o,key:null,value:null,onComplete:e}),s&&f()},exports.get=function(e,n){a.push({fn:t,key:e,value:null,onComplete:n}),s&&f()},exports.remove=function(e,n){void 0===n&&(n=c),a.push({fn:r,key:e,value:null,onComplete:n}),s&&f()},exports.set=function(e,r,t){void 0===t&&(t=c),a.push({fn:n,key:e,value:r,onComplete:t}),s&&f()};
